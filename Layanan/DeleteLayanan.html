<!-- ==================== MODAL DELETE & DETAIL LAYANAN ==================== -->

<!-- Modal Konfirmasi Hapus -->
<dialog id="modal_delete_layanan" class="modal modal-bottom sm:modal-middle">
  <div class="modal-box">
    <h3 class="text-lg font-bold mb-4">Konfirmasi Hapus</h3>
    <p class="py-4">Apakah Anda yakin ingin menghapus layanan <strong id="delete_nama"></strong>?</p>
    <input type="hidden" id="delete_id">
    <div class="modal-action">
      <button class="btn" onclick="modal_delete_layanan.close()">Batal</button>
      <button class="btn btn-error" onclick="confirmDeleteLayanan()">Hapus</button>
    </div>
  </div>
</dialog>

<!-- Modal Detail Layanan -->
<dialog id="modal_detail_layanan" class="modal modal-bottom sm:modal-middle">
  <div class="modal-box">
    <h3 class="text-lg font-bold mb-4">Detail Layanan</h3>
    <div class="space-y-3">
      <div>
        <label class="font-semibold">ID Layanan:</label>
        <p id="detail_id" class="text-base-content/70"></p>
      </div>
      <div>
        <label class="font-semibold">Nama Layanan:</label>
        <p id="detail_nama" class="text-base-content/70"></p>
      </div>
      <div>
        <label class="font-semibold">Harga per Kg:</label>
        <p id="detail_harga" class="text-base-content/70"></p>
      </div>
      <div>
        <label class="font-semibold">Durasi:</label>
        <p id="detail_durasi" class="text-base-content/70"></p>
      </div>
      <div>
        <label class="font-semibold">Deskripsi:</label>
        <p id="detail_deskripsi" class="text-base-content/70"></p>
      </div>
      <div>
        <label class="font-semibold">Status:</label>
        <p id="detail_status" class="text-base-content/70"></p>
      </div>
    </div>
    <div class="modal-action">
      <form method="dialog">
        <button class="btn">Tutup</button>
      </form>
    </div>
  </div>
</dialog>

<!-- ==================== SCRIPT DELETE & DETAIL LAYANAN ==================== -->
<script>
  /**
   * Delete & Detail Layanan Logic
   */

  // View Detail Layanan
  window.viewLayananData = function(btn) {
    var data = btn.dataset;
    document.getElementById('detail_id').textContent = data.id;
    document.getElementById('detail_nama').textContent = data.nama;
    document.getElementById('detail_harga').textContent = 'Rp ' + Number(data.harga).toLocaleString('id-ID');
    document.getElementById('detail_durasi').textContent = data.durasi + ' jam';
    document.getElementById('detail_deskripsi').textContent = data.deskripsi || '-';
    document.getElementById('detail_status').textContent = data.status;

    modal_detail_layanan.showModal();
  };

  // Delete Confirmation - Open modal
  window.deleteLayananConfirmData = function(btn) {
    var data = btn.dataset;
    document.getElementById('delete_id').value = data.id;
    document.getElementById('delete_nama').textContent = data.nama;
    modal_delete_layanan.showModal();
  };

  // Confirm Delete - Execute delete
  window.confirmDeleteLayanan = function() {
    var id = document.getElementById('delete_id').value;

    google.script.run
      .withSuccessHandler(function(result) {
        if (result.success) {
          alert(result.message);
          modal_delete_layanan.close();
          navigateTo('Layanan');
        } else {
          alert('Error: ' + result.message);
        }
      })
      .withFailureHandler(function(error) {
        alert('Error: ' + error.message);
      })
      .deleteLayanan(id);
  };
</script>
